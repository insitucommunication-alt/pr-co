<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cockpit DSI 2026 – Culture Coopération</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --maif-red: #d32f2f;
            --bg-neutral: #f8fafc;
            --border-color: #e2e8f0;
            --text-main: #1e293b;
            
            /* Couleurs des Axes */
            --axe1-color: #6fad9f;
            --axe2-color: #d15092;
            --axe3-color: #f1a53a;
            --axe4-color: #4693ad;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-neutral);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

        .glass-card {
            background: white;
            border: 1px solid var(--border-color);
            min-height: 165px;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            border-radius: 12px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        .glass-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transform: translateY(-3px);
        }

        .axe-label {
            font-size: 9px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .precon-id {
            font-size: 10px;
            font-weight: 900;
            color: #94a3b8;
        }

        .pilot-link {
            font-weight: 700;
            color: #475569;
            text-decoration: underline;
            text-underline-offset: 3px;
            text-decoration-color: #cbd5e1;
            transition: all 0.2s;
            z-index: 10;
            font-size: 11px;
        }
        .pilot-link:hover {
            color: var(--text-main);
            text-decoration-color: var(--text-main);
        }

        .progress-track {
            height: 6px;
            background-color: #f1f5f9;
            width: 100%;
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease-out;
        }

        .header-blur {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border-color);
        }

        .nav-link {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            padding-bottom: 4px;
            border-bottom: 2px solid transparent;
            color: #94a3b8;
            letter-spacing: 0.05em;
        }
        .nav-link.active {
            color: #1e293b;
            border-bottom-color: #1e293b;
        }

        .axe-filter-btn {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: #64748b;
            letter-spacing: 0.02em;
            transition: color 0.2s;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;  
            overflow: hidden;
        }
    </style>
</head>
<body>

    <header class="header-blur sticky top-0 z-50 px-8 py-4">
        <div class="max-w-[1600px] mx-auto grid grid-cols-3 items-center">
            <!-- Gauche: Navigation -->
            <nav class="flex gap-8">
                <button onclick="switchView('grid')" id="btn-grid" class="nav-link active">Vos préconisations</button>
                <button onclick="switchView('piste')" id="btn-piste" class="nav-link">Tableau de bord</button>
            </nav>

            <!-- Centre: Titre Stratégique -->
            <div class="flex flex-col items-center text-center">
                <span class="text-[9px] font-bold uppercase tracking-[0.3em] text-slate-400 leading-tight">Vers une culture de la</span>
                <span class="text-lg font-black uppercase tracking-tight text-[#d32f2f] leading-none mt-1">Coopération renforcée</span>
            </div>

            <!-- Droite: Recherche -->
            <div class="flex justify-end">
                <input id="mainSearch" oninput="filterAll()" type="text" placeholder="Rechercher..." class="bg-gray-50 border border-gray-200 rounded-full px-5 py-1.5 text-xs w-56 focus:ring-1 focus:ring-slate-400 outline-none transition-all">
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto p-8">
        
        <div class="flex flex-col xl:flex-row justify-end items-center mb-10 gap-6 border-b border-gray-100 pb-6">
            <div class="flex gap-6 overflow-x-auto w-full xl:w-auto justify-start xl:justify-end no-scrollbar" id="axe-filters">
                <button class="axe-filter-btn active whitespace-nowrap" onclick="filterByAxe('all')" style="color: #1e293b;">Tout voir</button>
                <button class="axe-filter-btn whitespace-nowrap hover:opacity-80" onclick="filterByAxe(1)" style="color: var(--axe1-color)">Fondamentaux</button>
                <button class="axe-filter-btn whitespace-nowrap hover:opacity-80" onclick="filterByAxe(2)" style="color: var(--axe2-color)">La communauté m'aide</button>
                <button class="axe-filter-btn whitespace-nowrap hover:opacity-80" onclick="filterByAxe(3)" style="color: var(--axe3-color)">J'aide la communauté</button>
                <button class="axe-filter-btn whitespace-nowrap hover:opacity-80" onclick="filterByAxe(4)" style="color: var(--axe4-color)">Entraide collective</button>
            </div>
        </div>

        <!-- GRID VIEW -->
        <section id="view-grid">
            <div id="projectsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Généré par JS -->
            </div>
        </section>

        <!-- PISTE VIEW -->
        <section id="view-piste" class="hidden">
            <div id="pistesContainer" class="space-y-8">
                <!-- Généré par JS -->
            </div>
        </section>
    </main>

    <!-- Modal de Détail -->
    <div id="backdrop" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] hidden items-center justify-center p-4" onclick="if(event.target===this) closeModal()">
        <div class="bg-white max-w-xl w-full p-10 shadow-2xl rounded-2xl border border-gray-100 animate-in fade-in zoom-in duration-200">
            <div class="flex justify-between items-start mb-8">
                <div class="pr-6">
                    <span id="mAxe" class="text-[10px] uppercase tracking-widest font-black italic">AXE</span>
                    <h3 id="mTitle" class="text-2xl font-bold mt-2 leading-tight text-gray-900">Titre</h3>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-black p-2 text-xl">✕</button>
            </div>

            <div class="flex items-center justify-between bg-slate-50 p-5 rounded-xl mb-8">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white border border-slate-200 rounded-lg flex items-center justify-center text-sm font-bold text-slate-400" id="mAvatar">--</div>
                    <div>
                        <span class="text-[9px] uppercase text-gray-400 font-black block mb-1">Responsable</span>
                        <span id="mPilot" class="text-base font-bold text-slate-800">NOM PORTEUR</span>
                    </div>
                </div>
                <button id="mContactBtn" class="bg-white border border-slate-200 text-slate-700 px-5 py-2.5 rounded-lg text-[10px] font-black uppercase tracking-wider hover:bg-slate-50 transition-colors shadow-sm">
                    Envoyer un message
                </button>
            </div>

            <p id="mDesc" class="text-base text-gray-500 leading-relaxed mb-8">Description...</p>

            <div id="editZone" class="border-t border-gray-100 pt-8">
                <div class="flex justify-between items-end mb-5">
                    <span class="text-[10px] uppercase font-black text-gray-400">Progression Actuelle</span>
                    <span id="mProgressText" class="text-3xl font-black italic">0%</span>
                </div>
                <input id="mSlider" type="range" min="0" max="100" class="w-full h-2 bg-gray-100 rounded-lg appearance-none cursor-pointer" oninput="updateModalProgress(this.value)">
                
                <button id="saveBtn" onclick="saveProgress()" class="w-full bg-slate-900 text-white py-4 mt-8 rounded-xl text-xs font-bold uppercase tracking-[0.2em] hover:bg-slate-800 transition-all shadow-lg">
                    Mettre à jour le levier
                </button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'dsi_cockpit_data_v3'; 
        const axeLabels = ["", "Les fondamentaux", "La communauté m'aide", "J'aide la communauté", "Entraide collective"];
        const axeColors = ["", "#6fad9f", "#d15092", "#f1a53a", "#4693ad"];
        const pilotsNames = ["David P.", "Anne D.", "Vanessa G.", "Sylvie Z.", "Marc L.", "Kevin M.", "Isabelle R.", "Julien C.", "Arthur C.", "Angélique B."];
        
        let projects = [];
        let filterAxe = 'all';
        let activeId = null;

        function initData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                projects = JSON.parse(saved);
            } else {
                for(let i=1; i<=39; i++) {
                    const axeIdx = (i % 4) + 1;
                    projects.push({
                        id: i,
                        axe: axeIdx,
                        title: getInitialTitle(i),
                        pilot: pilotsNames[i % pilotsNames.length],
                        progress: Math.floor(Math.random() * 40), 
                        desc: getInitialDesc(i)
                    });
                }
                saveToStorage();
            }
        }

        function saveToStorage() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
        }

        function getInitialTitle(i) {
            const titles = ["Cartographie compétences", "Standard Knowledge", "Reporting JIRA", "Portail Roadmap", "Synergie Métier", "Socle DevOps", "Observabilité", "Gouvernance Data", "Culture FinOps"];
            return titles[i % titles.length] + " (Préco #" + String(i).padStart(2, '0') + ")";
        }

        function getInitialDesc(i) {
            return "Action stratégique n°" + i + " visant à renforcer l'efficacité opérationnelle et la fluidité des échanges au sein de la DSI pour la trajectoire 2026.";
        }

        function switchView(view) {
            document.getElementById('view-grid').classList.toggle('hidden', view !== 'grid');
            document.getElementById('view-piste').classList.toggle('hidden', view !== 'piste');
            document.getElementById('btn-grid').classList.toggle('active', view === 'grid');
            document.getElementById('btn-piste').classList.toggle('active', view === 'piste');
        }

        function filterByAxe(axe) {
            filterAxe = axe;
            document.querySelectorAll('.axe-filter-btn').forEach((btn, idx) => {
                btn.classList.remove('font-extrabold', 'underline', 'decoration-2', 'underline-offset-4');
                btn.style.opacity = "0.6";
                if ((axe === 'all' && idx === 0) || (axe == idx)) {
                    btn.classList.add('font-extrabold', 'underline', 'decoration-2', 'underline-offset-4');
                    btn.style.opacity = "1";
                }
            });
            filterAll();
        }

        function filterAll() {
            const search = document.getElementById('mainSearch').value.toLowerCase();
            const filtered = projects.filter(p => {
                const mAxe = filterAxe === 'all' || p.axe == filterAxe;
                const mSearch = p.title.toLowerCase().includes(search) || p.pilot.toLowerCase().includes(search);
                return mAxe && mSearch;
            });
            renderGrid(filtered);
            renderPistes(filtered);
        }

        function renderGrid(data) {
            const grid = document.getElementById('projectsGrid');
            grid.innerHTML = "";
            data.forEach(p => {
                const color = axeColors[p.axe];
                const num = String(p.id).padStart(2, '0');
                const cardStyle = `onmouseover="this.style.borderColor='${color}'" onmouseout="this.style.borderColor='#e2e8f0'"`;

                grid.innerHTML += `
                    <div class="glass-card" ${cardStyle} onclick="if(!event.target.closest('.pilot-link')) openModal(${p.id})">
                        <div class="flex justify-between items-start mb-4">
                            <span class="axe-label" style="color:${color}">${axeLabels[p.axe]}</span>
                            <span class="precon-id">#${num}</span>
                        </div>
                        <h3 class="text-sm font-bold leading-tight text-slate-900 mb-2 line-clamp-2 h-10 italic">${p.title}</h3>
                        <p class="text-xs text-slate-500 line-clamp-2 mb-6">${p.desc}</p>
                        <div class="mt-auto">
                            <div class="flex justify-between items-end mb-2">
                                <span class="pilot-link" onclick="contactPilot('${p.pilot}', '${p.title}')">${p.pilot}</span>
                                <span class="text-xs font-black italic" style="color:${color}">${p.progress}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: ${p.progress}%; background-color: ${color}"></div>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function renderPistes(data) {
            const container = document.getElementById('pistesContainer');
            container.innerHTML = "";
            for(let i=1; i<=4; i++) {
                if (filterAxe !== 'all' && filterAxe != i) continue;
                const color = axeColors[i];
                container.innerHTML += `
                    <div class="bg-white border border-gray-100 p-8 rounded-xl">
                        <span class="text-[10px] font-black uppercase tracking-widest italic mb-6 block" style="color:${color}">${axeLabels[i]}</span>
                        <div class="relative h-20 flex items-center pt-4">
                            <div class="absolute inset-x-0 h-[2px] bg-slate-100 top-1/2 -translate-y-1/2"></div>
                            <div class="absolute inset-x-0 h-full pointer-events-none select-none">
                                <div class="absolute left-0 top-1/2 -translate-y-1/2 h-4 w-[2px] bg-slate-200"></div>
                                <div class="absolute left-0 top-[70%] text-[10px] font-bold text-slate-400 -translate-x-1/2">0%</div>
                                <div class="absolute left-[25%] top-1/2 -translate-y-1/2 h-3 w-[1px] bg-slate-200"></div>
                                <div class="absolute left-[25%] top-[70%] text-[10px] font-bold text-slate-400 -translate-x-1/2">25%</div>
                                <div class="absolute left-[50%] top-1/2 -translate-y-1/2 h-4 w-[2px] bg-slate-200"></div>
                                <div class="absolute left-[50%] top-[70%] text-[10px] font-bold text-slate-400 -translate-x-1/2">50%</div>
                                <div class="absolute right-0 top-1/2 -translate-y-1/2 h-4 w-[2px] bg-slate-200"></div>
                                <div class="absolute right-0 top-[70%] text-[10px] font-bold text-slate-400 translate-x-1/2">100%</div>
                            </div>
                            <div id="track-${i}" class="relative w-full h-full z-10"></div>
                        </div>
                    </div>
                `;
                const track = document.getElementById(`track-${i}`);
                data.filter(p => p.axe === i).forEach(p => {
                    const jitter = ((p.id * 17) % 36) - 18;
                    const pion = document.createElement('div');
                    pion.style.cssText = `
                        width: 28px; height: 28px; background: white; border: 2px solid ${color}; color: ${color};
                        font-size: 10px; font-weight: 800; display: grid; place-items: center;
                        border-radius: 8px; position: absolute; cursor: pointer;
                        left: ${p.progress}%; top: calc(50% + ${jitter}px); transform: translate(-50%, -50%);
                        box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                    `;
                    pion.innerHTML = p.id;
                    pion.onclick = () => openModal(p.id);
                    pion.onmouseenter = () => { pion.style.transform = 'translate(-50%, -50%) scale(1.3)'; pion.style.zIndex = 50; pion.style.background = color; pion.style.color = 'white'; };
                    pion.onmouseleave = () => { pion.style.transform = 'translate(-50%, -50%) scale(1)'; pion.style.zIndex = 1; pion.style.background = 'white'; pion.style.color = color; };
                    track.appendChild(pion);
                });
            }
        }

        function openModal(id) {
            activeId = id;
            const p = projects.find(x => x.id === id);
            const color = axeColors[p.axe];

            document.getElementById('mTitle').textContent = p.title;
            const axeSpan = document.getElementById('mAxe');
            axeSpan.textContent = `AXE ${p.axe} : ${axeLabels[p.axe]}`;
            axeSpan.style.color = color;

            document.getElementById('mPilot').textContent = p.pilot;
            document.getElementById('mAvatar').textContent = p.pilot.split(' ').map(n=>n[0]).join('');
            document.getElementById('mDesc').textContent = p.desc;
            
            const slider = document.getElementById('mSlider');
            slider.value = p.progress;
            slider.style.accentColor = color;
            
            const progressText = document.getElementById('mProgressText');
            progressText.style.color = color;
            updateModalProgress(p.progress);

            document.getElementById('mContactBtn').onclick = () => contactPilot(p.pilot, p.title);
            document.getElementById('backdrop').classList.replace('hidden', 'flex');
        }

        function closeModal() {
            document.getElementById('backdrop').classList.replace('flex', 'hidden');
        }

        function updateModalProgress(val) {
            document.getElementById('mProgressText').textContent = `${val}%`;
        }

        function saveProgress() {
            const p = projects.find(x => x.id === activeId);
            p.progress = parseInt(document.getElementById('mSlider').value);
            saveToStorage();
            filterAll();
            closeModal();
        }

        function contactPilot(name, title) {
            const email = name.toLowerCase().replace(' ', '.') + "@maif.fr";
            window.location.href = `mailto:${email}?subject=Levier Transfo: ${title}`;
        }

        window.onload = () => {
            initData();
            filterAll();
        };
    </script>
</body>
</html>
