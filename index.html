<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cockpit DSI 2026 – Connect Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --maif-red: #d32f2f;
            --bg-neutral: #f8fafc;
            --border-color: #e2e8f0;
            --text-main: #1e293b;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-neutral);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

        /* Cartes ultra-compactes */
        .glass-card {
            background: white;
            border: 1px solid var(--border-color);
            min-height: 140px;
            display: flex;
            flex-direction: column;
            padding: 0.85rem;
            border-radius: 8px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        .glass-card:hover {
            border-color: var(--maif-red);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transform: translateY(-1px);
        }

        .axe-label {
            font-size: 7.5px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--maif-red);
        }

        .precon-id {
            font-size: 9px;
            font-weight: 900;
            color: #94a3b8;
        }

        .pilot-link {
            font-weight: 700;
            color: #475569;
            text-decoration: underline;
            text-underline-offset: 2px;
            text-decoration-color: #cbd5e1;
            transition: all 0.2s;
            z-index: 10;
        }
        .pilot-link:hover {
            color: var(--maif-red);
            text-decoration-color: var(--maif-red);
        }

        .progress-track {
            height: 4px;
            background-color: #f1f5f9;
            width: 100%;
            border-radius: 4px;
            margin-top: 4px;
        }
        .progress-fill {
            height: 100%;
            background-color: var(--maif-red);
            border-radius: 4px;
        }

        .header-blur {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border-color);
        }

        .nav-link {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            padding-bottom: 4px;
            border-bottom: 2px solid transparent;
            color: #94a3b8;
        }
        .nav-link.active {
            color: var(--maif-red);
            border-bottom-color: var(--maif-red);
        }

        .axe-filter-btn {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            color: #64748b;
        }
        .axe-filter-btn.active { color: var(--maif-red); font-weight: 900; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* Limitation des lignes pour garder les cartes petites */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;  
            overflow: hidden;
        }
    </style>
</head>
<body>

    <header class="header-blur sticky top-0 z-50 px-8 py-3">
        <div class="max-w-[1600px] mx-auto flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="w-8 h-8 bg-black text-white flex items-center justify-center rounded-lg text-xs font-black italic">M</div>
                <div>
                    <h1 class="text-base font-light tracking-tight leading-none uppercase">Transfo<span class="text-[#d32f2f] font-bold italic">2026</span></h1>
                    <p class="text-[8px] uppercase tracking-[0.2em] text-gray-400 mt-1 font-bold">Cockpit DSI Connect</p>
                </div>
            </div>

            <nav class="hidden md:flex gap-8">
                <button onclick="switchView('grid')" id="btn-grid" class="nav-link active">Bourse aux leviers</button>
                <button onclick="switchView('piste')" id="btn-piste" class="nav-link">Dynamique Agile</button>
            </nav>

            <div class="flex items-center gap-4">
                <input id="mainSearch" oninput="filterAll()" type="text" placeholder="Rechercher..." class="bg-gray-50 border border-gray-200 rounded-full px-4 py-1 text-[11px] w-40 focus:ring-1 focus:ring-red-600 outline-none">
                <div class="w-7 h-7 rounded-full bg-slate-200 border border-white flex items-center justify-center text-[9px] font-bold">JD</div>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto p-6">
        
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4 border-b border-gray-100 pb-4">
            <div class="flex gap-4 items-center">
                <h2 class="text-lg font-bold text-slate-800 italic">Portfolio <span class="text-red-600">39 leviers</span></h2>
                <div class="h-4 w-[1px] bg-slate-200 mx-2"></div>
                <div id="pilotsList" class="flex gap-3 overflow-x-auto no-scrollbar max-w-md">
                    <!-- Généré par JS -->
                </div>
            </div>
            <div class="flex gap-4" id="axe-filters">
                <button class="axe-filter-btn active" onclick="filterByAxe('all')">Tous</button>
                <button class="axe-filter-btn" onclick="filterByAxe(1)">Fondamentaux</button>
                <button class="axe-filter-btn" onclick="filterByAxe(2)">La communauté m'aide</button>
                <button class="axe-filter-btn" onclick="filterByAxe(3)">J'aide la communauté</button>
                <button class="axe-filter-btn" onclick="filterByAxe(4)">Collectifs</button>
            </div>
        </div>

        <!-- GRID VIEW -->
        <section id="view-grid">
            <div id="projectsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-3">
                <!-- Généré par JS -->
            </div>
        </section>

        <!-- PISTE VIEW -->
        <section id="view-piste" class="hidden">
            <div id="pistesContainer" class="space-y-6">
                <!-- Généré par JS -->
            </div>
        </section>
    </main>

    <!-- Modal de Détail -->
    <div id="backdrop" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] hidden items-center justify-center p-4" onclick="if(event.target===this) closeModal()">
        <div class="bg-white max-w-xl w-full p-8 shadow-2xl rounded-2xl border border-gray-100 animate-in fade-in zoom-in duration-200">
            <div class="flex justify-between items-start mb-6">
                <div class="pr-6">
                    <span id="mAxe" class="text-[9px] uppercase tracking-widest text-red-600 font-black italic">AXE</span>
                    <h3 id="mTitle" class="text-xl font-bold mt-1 leading-tight text-gray-900">Titre</h3>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-black p-1">✕</button>
            </div>

            <div class="flex items-center justify-between bg-slate-50 p-4 rounded-xl mb-6">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white border border-slate-200 rounded-lg flex items-center justify-center text-xs font-bold text-slate-400" id="mAvatar">--</div>
                    <div>
                        <span class="text-[8px] uppercase text-gray-400 font-black block">Responsable</span>
                        <span id="mPilot" class="text-sm font-bold text-slate-800">NOM PORTEUR</span>
                    </div>
                </div>
                <button id="mContactBtn" class="bg-black text-white px-4 py-2 rounded-lg text-[9px] font-black uppercase tracking-wider hover:bg-red-600 transition-colors">
                    Envoyer un message
                </button>
            </div>

            <p id="mDesc" class="text-sm text-gray-500 leading-relaxed mb-6">Description...</p>

            <div class="border-t border-gray-100 pt-6">
                <div class="flex justify-between items-end mb-4">
                    <span class="text-[9px] uppercase font-black text-gray-400">Progression Actuelle</span>
                    <span id="mProgressText" class="text-2xl font-black text-red-600 italic">0%</span>
                </div>
                <input id="mSlider" type="range" min="0" max="100" class="w-full accent-[#d32f2f] h-1.5 bg-gray-100 rounded-lg appearance-none cursor-pointer" oninput="updateModalProgress(this.value)">
            </div>

            <button onclick="saveProgress()" class="w-full bg-red-600 text-white py-4 mt-8 rounded-xl text-[10px] font-bold uppercase tracking-[0.2em] hover:bg-red-700 transition-all">Mettre à jour le levier</button>
        </div>
    </div>

    <script>
        // Configuration des axes
        const axeLabels = ["", "Fondamentaux", "La communauté m'aide", "J'aide la communauté", "Collectifs"];
        
        // Base de données simulée (39 éléments)
        const pilotsNames = ["David P.", "Anne D.", "Vanessa G.", "Sylvie Z.", "Marc L.", "Kevin M.", "Isabelle R.", "Julien C.", "Arthur C.", "Angélique B."];
        const projects = [];

        // Génération des 39 préconisations
        for(let i=1; i<=39; i++) {
            const axeIdx = (i % 4) + 1;
            projects.push({
                id: i,
                axe: axeIdx,
                title: getTitle(i),
                pilot: pilotsNames[i % pilotsNames.length],
                progress: Math.floor(Math.random() * 95),
                desc: getDesc(i)
            });
        }

        function getTitle(i) {
            const titles = [
                "Cartographie des compétences critiques", "Standardisation du Knowledge Technique", "Reporting JIRA & Dashboards",
                "Portail Roadmap Transverse", "Synergie Métier / Pilotage SI", "Socle DevOps & CI/CD", 
                "Observabilité applicative", "Gouvernance de la donnée agile", "Culture FinOps DSI"
            ];
            return titles[i % titles.length] + " (Préco #" + String(i).padStart(2, '0') + ")";
        }

        function getDesc(i) {
            return "Action stratégique n°" + i + " visant à renforcer l'efficacité opérationnelle et la fluidité des échanges au sein de la DSI pour la trajectoire 2026.";
        }

        let filterAxe = 'all';
        let filterPilot = 'all';
        let activeId = null;

        function switchView(view) {
            document.getElementById('view-grid').classList.toggle('hidden', view !== 'grid');
            document.getElementById('view-piste').classList.toggle('hidden', view !== 'piste');
            document.getElementById('btn-grid').classList.toggle('active', view === 'grid');
            document.getElementById('btn-piste').classList.toggle('active', view === 'piste');
        }

        function contactPilot(name, projectTitle = "") {
            const email = name.toLowerCase().replace(' ', '.') + "@maif.fr";
            const subject = encodeURIComponent(`Transfo 2026 - Levier : ${projectTitle}`);
            const body = encodeURIComponent(`Bonjour ${name},\n\nConcernant la préconisation "${projectTitle}", j'aurais une question...`);
            window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
        }

        function renderPilots() {
            const container = document.getElementById('pilotsList');
            const uniq = [...new Set(projects.map(p => p.pilot))].sort();
            container.innerHTML = `<button onclick="setPilotFilter('all')" class="text-[9px] font-bold uppercase transition-colors ${filterPilot === 'all' ? 'text-red-600 underline' : 'text-slate-400'}">Tous</button>`;
            uniq.forEach(p => {
                container.innerHTML += `<button onclick="setPilotFilter('${p}')" class="text-[9px] font-bold uppercase whitespace-nowrap transition-colors ${filterPilot === p ? 'text-red-600 underline' : 'text-slate-400'}">${p}</button>`;
            });
        }

        function setPilotFilter(p) {
            filterPilot = p;
            renderPilots();
            filterAll();
        }

        function filterByAxe(axe) {
            filterAxe = axe;
            document.querySelectorAll('.axe-filter-btn').forEach((btn, idx) => {
                btn.classList.toggle('active', (axe === 'all' && idx === 0) || (axe == idx));
            });
            filterAll();
        }

        function filterAll() {
            const search = document.getElementById('mainSearch').value.toLowerCase();
            const filtered = projects.filter(p => {
                const mAxe = filterAxe === 'all' || p.axe == filterAxe;
                const mPilot = filterPilot === 'all' || p.pilot == filterPilot;
                const mSearch = p.title.toLowerCase().includes(search) || p.pilot.toLowerCase().includes(search);
                return mAxe && mPilot && mSearch;
            });
            renderGrid(filtered);
            renderPistes(filtered);
        }

        function renderGrid(data) {
            const grid = document.getElementById('projectsGrid');
            grid.innerHTML = "";
            data.forEach(p => {
                const num = String(p.id).padStart(2, '0');
                grid.innerHTML += `
                    <div class="glass-card" onclick="if(!event.target.closest('.pilot-link')) openModal(${p.id})">
                        <div class="flex justify-between items-start mb-1.5">
                            <span class="axe-label">${axeLabels[p.axe]}</span>
                            <span class="precon-id">${num}</span>
                        </div>
                        
                        <h3 class="text-[11px] font-bold leading-tight text-slate-900 mb-1 line-clamp-1">
                            ${p.title}
                        </h3>

                        <p class="text-[10px] text-slate-500 line-clamp-2 leading-tight mb-2">
                            ${p.desc}
                        </p>

                        <div class="mt-auto">
                            <div class="flex justify-between items-end mb-1">
                                <span onclick="contactPilot('${p.pilot}', '${p.title}')" class="pilot-link text-[10px]">${p.pilot}</span>
                                <span class="text-[10px] font-black italic text-slate-900">${p.progress}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: ${p.progress}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function renderPistes(data) {
            const container = document.getElementById('pistesContainer');
            container.innerHTML = "";
            for(let i=1; i<=4; i++) {
                container.innerHTML += `
                    <div class="bg-white border border-gray-100 p-6 rounded-xl">
                        <span class="text-[9px] font-black uppercase tracking-widest text-gray-400 italic mb-4 block">${axeLabels[i]}</span>
                        <div class="relative h-12 flex items-center">
                            <div class="absolute inset-x-0 h-[1px] bg-gray-100"></div>
                            <div id="track-${i}" class="relative w-full h-full"></div>
                        </div>
                    </div>
                `;
                const track = document.getElementById(`track-${i}`);
                data.filter(p => p.axe === i).forEach(p => {
                    const jitter = ((p.id * 17) % 30) - 15;
                    const pion = document.createElement('div');
                    pion.style.cssText = `
                        width: 18px; height: 18px; background: white; border: 2px solid var(--maif-red);
                        font-size: 7px; font-weight: 900; display: grid; place-items: center;
                        border-radius: 4px; position: absolute; cursor: pointer;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.1); left: ${p.progress}%; top: calc(50% + ${jitter}px);
                    `;
                    pion.innerHTML = p.id;
                    pion.onclick = () => openModal(p.id);
                    track.appendChild(pion);
                });
            }
        }

        function openModal(id) {
            activeId = id;
            const p = projects.find(x => x.id === id);
            document.getElementById('mTitle').textContent = p.title;
            document.getElementById('mAxe').textContent = `AXE ${p.axe} : ${axeLabels[p.axe]}`;
            document.getElementById('mPilot').textContent = p.pilot;
            document.getElementById('mAvatar').textContent = p.pilot.split(' ').map(n=>n[0]).join('');
            document.getElementById('mDesc').textContent = p.desc;
            document.getElementById('mSlider').value = p.progress;
            document.getElementById('mContactBtn').onclick = () => contactPilot(p.pilot, p.title);
            updateModalProgress(p.progress);
            document.getElementById('backdrop').classList.replace('hidden', 'flex');
            document.body.style.overflow = 'hidden';
        }

        function updateModalProgress(val) {
            document.getElementById('mProgressText').textContent = `${val}%`;
        }

        function closeModal() {
            document.getElementById('backdrop').classList.replace('flex', 'hidden');
            document.body.style.overflow = '';
        }

        function saveProgress() {
            const p = projects.find(x => x.id === activeId);
            p.progress = parseInt(document.getElementById('mSlider').value);
            filterAll();
            closeModal();
        }

        window.onload = () => {
            renderPilots();
            filterAll();
        };
    </script>
</body>
</html>
